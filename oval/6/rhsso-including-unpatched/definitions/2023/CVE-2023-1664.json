{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20231664",
  "Version": "636",
  "Metadata": {
    "Title": "Untrusted Certificate Validation (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-1664",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-1664"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Keycloak. This flaw depends on a non-default configuration \"Revalidate Client Certificate\" to be enabled and the reverse proxy is not validating the certificate before Keycloak. Using this method an attacker may choose the certificate which will be validated by the server. If this happens and the KC_SPI_TRUSTSTORE_FILE_FILE variable is missing/misconfigured, any trustfile may be accepted with the logging information of \"Cannot validate client certificate trust: Truststore not available\". \n\nThis may not impact availability, but consumer applications Integrity or Confidentiality. Considering the environment is correctly set, this flaw is avoidable by configuring the server. \n            STATEMENT: Red Hat Impact rated as a low impact considering there's a mitigation for this issue which would be consider the environment is correctly set with the truststore file. With these settings, the environment there's no evidence of attack possibility. Also it's possible to track under the server logs for more evidences.\n            MITIGATION: Make sure KC_SPI_TRUSTSTORE_FILE_FILE is correctly set and the logs are not reporting the \"Cannot validate client certificate trust: Truststore not available\" after an attempt to explore the vulnerability. Note this message may happen under other scenarios and reasons but the expected behavior would be that a non-valid certificate to pass.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2023-06-27"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-1664",
          "Cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "Cwe": "CWE-295",
          "Impact": "low",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-1664",
          "Public": "20230327"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:red_hat_single_sign_on:7",
        "cpe:/a:redhat:red_hat_single_sign_on:7::el6"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201712161004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 6 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201712161003"
          },
          {
            "Comment": "rh-sso7-keycloak-server is installed",
            "TestRef": "oval:com.redhat.cve:tst:201712161001"
          },
          {
            "Comment": "rh-sso7-keycloak-server is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201712161002"
          }
        ]
      }
    ]
  }
}