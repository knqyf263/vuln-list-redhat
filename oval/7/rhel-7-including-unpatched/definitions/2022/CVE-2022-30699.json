{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202230699",
  "Version": "636",
  "Metadata": {
    "Title": "CVE-2022-30699 unbound: novel ghost domain attack that allows attackers to trigger continued resolvability of malicious domain names (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-30699",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-30699"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Unbound, which is vulnerable to a novel type of \"ghost domain names\" attack. The vulnerability works by targeting an Unbound instance. Unbound is queried for a subdomain of a rogue domain name. The rogue nameserver returns delegation information for the subdomain that updates Unbound's delegation cache. This action can be repeated before the expiry of the delegation information by querying Unbound for a second-level subdomain in which the rogue nameserver provides new delegation information. Since Unbound is a child-centric resolver, the ever-updating child delegation information can keep a rogue domain name resolvable long after revocation.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-12-06"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-30699",
          "Cvss3": "6.5/CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-613",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-30699",
          "Public": "20220801"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::container",
        "cpe:/o:redhat:enterprise_linux:7::containers",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105003"
                  },
                  {
                    "Comment": "unbound-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105005"
                  },
                  {
                    "Comment": "unbound-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105007"
                  },
                  {
                    "Comment": "unbound is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105001"
                  },
                  {
                    "Comment": "unbound-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}