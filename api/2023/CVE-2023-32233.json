{
  "mitigation": "1. This flaw can be mitigated by preventing the affected netfilter (nf_tables) kernel module from being loaded. For instructions on how to blacklist a kernel module, please see https://access.redhat.com/solutions/41278.\n2. If the module cannot be disabled, on non-containerized deployments of Red Hat Enterprise Linux, the mitigation is to disable user namespaces:\n```\n# echo \"user.max_user_namespaces=0\" \u003e /etc/sysctl.d/userns.conf\n# sysctl -p /etc/sysctl.d/userns.conf\n```\nOn containerized deployments, such as Red Hat OpenShift Container Platform, do not use the second mitigation (disabling user namespaces) as the functionality is needed to be enabled. The first mitigation (blacklisting nf_tables) is still viable for containerized deployments, providing the environment is not using netfilter.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-05-30T00:00:00Z",
      "advisory": "RHSA-2023:3350",
      "package": "kernel-rt-0:4.18.0-477.13.1.rt7.276.el8_8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-05-30T00:00:00Z",
      "advisory": "RHSA-2023:3349",
      "package": "kernel-0:4.18.0-477.13.1.el8_8",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-05-30T00:00:00Z",
      "advisory": "RHSA-2023:3351",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-06-21T00:00:00Z",
      "advisory": "RHSA-2023:3708",
      "package": "kernel-rt-0:5.14.0-284.18.1.rt14.303.el9_2",
      "cpe": "cpe:/a:redhat:enterprise_linux:9::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-06-21T00:00:00Z",
      "advisory": "RHSA-2023:3705",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-06-21T00:00:00Z",
      "advisory": "RHSA-2023:3723",
      "package": "kernel-0:5.14.0-284.18.1.el9_2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2023-06-06T00:00:00Z",
      "advisory": "RHSA-2023:3465",
      "package": "kernel-0:5.14.0-70.58.1.el9_0",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2023-06-06T00:00:00Z",
      "advisory": "RHSA-2023:3470",
      "package": "kernel-rt-0:5.14.0-70.58.1.rt21.129.el9_0",
      "cpe": "cpe:/a:redhat:rhel_eus:9.0::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "release_date": "2023-06-06T00:00:00Z",
      "advisory": "RHSA-2023:3490",
      "package": "kpatch-patch",
      "cpe": "cpe:/o:redhat:rhel_eus:9.0"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2023-05-02T04:30:00Z",
  "bugzilla": {
    "description": "use-after-free in nf_tables when processing batch requests can lead to privilege escalation",
    "id": "2196105",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2196105"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "Only local users with `CAP_NET_ADMIN` capability (or root) can trigger this issue. \nOn Red Hat Enterprise Linux, local unprivileged users can exploit unprivileged user namespaces (CONFIG_USER_NS) to grant themselves this capability.\nThe OpenShift Container Platform (OCP) control planes or master machines are based on Red Hat Enterprise Linux CoreOS (RHCOS) that consists primarily of RHEL components, hence is also affected by this kernel vulnerability. Like it is mentioned earlier, the successful exploit needs necessary privileges (CAP_NET_ADMIN) and direct, local access . Local user in RHCOS is already a root with full permissions, hence existence of this vulnerability does not bring any value from the potential attacker perspective. From the OpenShift containers perspective, this vulnerability cannot be exploited as in OpenShift the cluster processes on the node are namespaced, which means that switching in the running OpenShift container the namespace will not bring necessary capabilities.\nThis means that for OpenShift, the impact of this vulnerability is Low.\nSimilar to CVE-2023-32233 vulnerability has been explained in the following blog post as an example of \"Container escape vulnerability\":\nhttps://www.redhat.com/en/blog/containers-vulnerability-risk-assessment",
  "acknowledgement": "Red Hat would like to thank Patryk Sondej and Piotr Krysiuk for reporting this issue.",
  "name": "CVE-2023-32233",
  "document_distribution": "",
  "details": [
    "In the Linux kernel through 6.3.1, a use-after-free in Netfilter nf_tables when processing batch requests can be abused to perform arbitrary read and write operations on kernel memory. Unprivileged local users can obtain root privileges. This occurs because anonymous sets are mishandled.",
    "A use-after-free vulnerability was found in the Netfilter subsystem of the Linux kernel when processing batch requests to update nf_tables configuration. This vulnerability can be abused to perform arbitrary reads and writes in kernel memory. A local user (with CAP_NET_ADMIN capability) could use this flaw to crash the system or potentially escalate their privileges on the system."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-32233\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-32233\nhttps://github.com/torvalds/linux/commit/c1592a89942e9678f7d9c8030efa777c0d57edab\nhttps://www.openwall.com/lists/oss-security/2023/05/08/4"
  ]
}