{
  "mitigation": "We recommend disabling Active Directory in the Grafana configuration file until a fix is provided.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Cryostat 2",
      "fix_state": "Not affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:cryostat:2"
    },
    {
      "product_name": "OpenShift Service Mesh 2.1.x",
      "fix_state": "Affected",
      "package_name": "servicemesh-grafana",
      "cpe": "cpe:/a:redhat:service_mesh:2.1::el8"
    },
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 4",
      "fix_state": "Affected",
      "package_name": "rhceph/rhceph-4-dashboard-rhel8",
      "cpe": "cpe:/a:redhat:ceph_storage:4"
    },
    {
      "product_name": "Red Hat Ceph Storage 5",
      "fix_state": "Affected",
      "package_name": "rhceph/rhceph-5-dashboard-rhel8",
      "cpe": "cpe:/a:redhat:ceph_storage:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Affected",
      "package_name": "grafana",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Critical",
  "public_date": "2023-06-22T00:00:00Z",
  "bugzilla": {
    "description": "account takeover possible when using Azure AD OAuth",
    "id": "2213626",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2213626"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "For Red Hat Enterprise Linux, Azure Active Directory access is not supported, therefore it is disabled by default in the Grafana configuration file located at /etc/grafana/grafana.ini in the Azure AD section. In the unlikely event that someone has enabled Azure Active Directory access, they have the option to revert it back to the default state of disabling it.\nThe versions of Red Hat OpenShift Container Platform from 4.11 and beyond are not affected by this issue as it doesn't ship Grafana anymore.",
  "acknowledgement": "",
  "name": "CVE-2023-3128",
  "document_distribution": "",
  "details": [
    "Grafana is validating Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique and can be easily modified. This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app.",
    "A flaw was found in Grafana, which validates Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique across Azure AD tenants, which enables Grafana account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant AzureAD OAuth application.Â This may allow an attacker to gain complete control of the user's account, including access to private customer data and sensitive information."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-3128\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-3128\nhttps://grafana.com/blog/2023/06/22/grafana-security-release-for-cve-2023-3128/"
  ]
}